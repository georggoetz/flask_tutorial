{% extends 'base.jinja2' %}

{% block header %}
{% endblock %}

{% block content %}
{% for post in posts %}
<article class="card post">
  <header class="post__header">
    <h1 class="post__title">{{ post.title }}</h1>
    <div class="post__meta">
      <span class="post__author">by {{ post.author.username }}</span>
      <span class="post__date">
        <svg class="post__date-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
          <path
            d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z" />
        </svg>
        {{ post.created.strftime('%-d %B %Y') }}
      </span>
    </div>
  </header>
  <section>
    <div class="post__preview">
      {{ post.content.body[:200] }}{% if post.content.body|length > 200 %}...{% endif %}
    </div>
    <div class="post__actions">
      <a class="button post__action" href="{{ url_for('blog.index', id=post.id) }}">Read more</a>
      {% if g.user.id == post['author_id'] %}
      <a class="button post__action" href="{{ url_for('blog.update', id=post.id) }}">Edit</a>
      {% endif %}
      {% with post=post %}
      {% include 'components/post_likes.jinja2' %}
      {% endwith %}
    </div>
  </section>
</article>
{% endfor %}

{% with page=page, total_pages=total_pages, url='blog.page' %}
{% include 'components/pagination.jinja2' %}
{% endwith %}

{% if g.user %}
<a class="button fab" href="{{ url_for('blog.create') }}" title="Neuer Post">
  <svg class="fab__icon" width="1.6em" height="1.6em" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
    <rect x="11" y="7" width="2" height="10" rx="1" fill="currentColor"/>
    <rect x="7" y="11" width="10" height="2" rx="1" fill="currentColor"/>
  </svg>
</a>
{% endif %}
{% endblock %}